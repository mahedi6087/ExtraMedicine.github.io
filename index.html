<!-- ... (your existing <head> and <style> section stay the same) -->
<!-- Add these extra styles at the bottom of your <style> tag: -->

<style>
  /* ... existing styles ... */

  .breakdown-button {
    margin: 20px auto;
    padding: 10px 20px;
    background: #0077ff;
    color: white;
    font-weight: bold;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .breakdown-button:hover {
    background: #005fcc;
  }

  .grade-breakdown {
    margin-top: 20px;
    display: none;
  }

  .grade-card {
    background: rgba(0, 0, 0, 0.85);
    border: 2px solid cyan;
    color: #fff;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 15px;
    font-size: 15px;
    text-align: left;
  }

  body.dark .grade-card {
    background: rgba(255, 255, 255, 0.1);
  }
</style>

<!-- Inside your <body> in the #gradeSection area: -->
<div class="section" id="gradeSection">
  <h2>Your Current Grade</h2>
  <p style="text-align: center; font-size: 22px; font-weight: bold; margin: 20px 0;">
    üìà Grade Overview (Percentage)
  </p>
  <div id="gradeContainer" style="text-align: center;"></div>

  <button class="breakdown-button" onclick="toggleBreakdown()">üìã Show Grade Breakdown</button>
  <div id="gradeBreakdown" class="grade-breakdown"></div>

  <p style="text-align: center; font-size: 14px; color: #888; margin-top: 10px;">
    (Powered by your Google Apps Script)
  </p>
</div>

<!-- At the end of your <body>, include or update your <script> tag like this: -->

<script>
  let gradeData = null;

  document.addEventListener("DOMContentLoaded", () => {
    loadGrades();
  });

  function loadGrades() {
    const scriptUrl = "https://script.google.com/macros/s/AKfycbwncPoHJAx8iIM7-F8m7jtLK8cRz4kFYGYPAogWqyHjUpmL6lpR5dsKmp2eZtBSfq7s5w/exec";
    const gradeContainer = document.getElementById("gradeContainer");

    fetch(scriptUrl)
      .then(response => response.json())
      .then(data => {
        gradeData = data; // Store for breakdown use
        const { totalReceived, totalPossible, percentage } = data;

        gradeContainer.innerHTML = `
          <p><strong>‚úÖ Total Grade Received:</strong> ${totalReceived}</p>
          <p><strong>üìä Total Possible Grade:</strong> ${totalPossible}</p>
          <p><strong>üìà Final Grade Percentage:</strong> ${percentage}%</p>
          <div class="progress-bar-wrapper">
            <div class="progress-bar-fill" id="gradeBar">${percentage}%</div>
          </div>
        `;

        setTimeout(() => {
          const bar = document.getElementById("gradeBar");
          bar.style.width = percentage + "%";
          bar.style.background = percentage >= 80
            ? "linear-gradient(90deg, #00ff99, #00cc66)"
            : percentage >= 60
            ? "linear-gradient(90deg, #ffcc00, #ffaa00)"
            : "linear-gradient(90deg, #ff5555, #ff0000)";
        }, 100);
      })
      .catch(error => {
        console.error("Error loading grade data:", error);
        gradeContainer.innerHTML = "<p style='color:red;'>‚ö†Ô∏è Failed to load grade data.</p>";
      });
  }

  function toggleBreakdown() {
    const section = document.getElementById("gradeBreakdown");
    if (!gradeData || !gradeData.breakdown) {
      section.innerHTML = "<p style='color:red;'>No breakdown data found.</p>";
      section.style.display = "block";
      return;
    }

    if (section.style.display === "block") {
      section.style.display = "none";
      return;
    }

    section.innerHTML = "<h3 style='color:deeppink; text-align:center;'>Grade Breakdown</h3>";

    gradeData.breakdown.forEach(item => {
      const percent = ((item.grade_received / item.max_grade) * 100).toFixed(1);
      const card = document.createElement("div");
      card.className = "grade-card";
      card.innerHTML = `
        <strong>${item.grade_name} (${item.grade_type})</strong><br>
        Received: ${item.grade_received} / ${item.max_grade}<br>
        Percentage: ${percent}%<br>
        Course: ${item.course_code}
      `;
      section.appendChild(card);
    });

    section.style.display = "block";
  }

  function showSection(sectionId) {
    document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
    document.getElementById(sectionId).classList.add('active');
  }

  function showInfo(type) {
    const info = document.getElementById("info");
    showSection("info");
    if (type === "bachelor") {
      info.innerHTML = "<h2>Bachelor's Info</h2><p>Admission Fee: 990 Won<br>Date: 19/05/2025</p>";
    } else if (type === "master") {
      info.innerHTML = "<h2>Master's Info</h2><p>CGPA: 3.99 required<br>Admission Fee: 1190 Won</p>";
    } else if (type === "result") {
      info.innerHTML = "<h2>Results</h2><p>MAHEDI: 4.29, JOY: 3.98, ROHAN: 4.07</p>";
    } else if (type === "scholarship") {
      info.innerHTML = "<h2>Scholarships</h2><p>CGPA 4.00 = 50%<br>CGPA 4.50 = 100%</p>";
    }
  }

  function submitAssignment() {
    const link = document.getElementById("driveLink").value.trim();
    if (link) {
      const entry = document.createElement("p");
      entry.innerHTML = `üìÇ <a href="${link}" target="_blank">View New Assignment</a>`;
      document.getElementById("assignmentList").appendChild(entry);
      alert("Assignment submitted successfully!");
      document.getElementById("driveLink").value = "";
    }
  }

  function toggleDarkMode() {
    document.body.classList.toggle("dark");
  }
</script>
